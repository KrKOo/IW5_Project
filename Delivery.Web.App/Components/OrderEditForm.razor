@namespace Delivery.Web.App
@inherits Delivery.Web.App.Pages.PageBase

<EditForm Model="@Data">
    <DataAnnotationsValidator />

    <div class="form-group">
        <label class="w-100">
           Address
           <InputText @bind-Value="@Data.Address" class="form-control" />
           <small class="form-text text-danger">
               <ValidationMessage For="@(() => Data.Address)" />
           </small>
        </label>
    </div>

    <div class="form-group">
        <label class="w-100">
            Note
            <InputTextArea @bind-Value="@Data.Note" class="form-control" />
            <small class="form-text text-danger">
                <ValidationMessage For="@(() => Data.Note)" />
            </small>
        </label>
    </div>

    
        <div class="col-md-6 p-3 ">
            <div class="bg-sec p-3 rounded">
                <h2>Add dishes</h2>

                <div class="input-group">
                    <div class="input-group-prepend">
                        <InputSelect @bind-Value="SelectedDishId" class="form-control">
                            @foreach (var dish in RestaurantDishes)
                                {
                                    <option value="@dish.Id">@dish.Name</option>
                                }
                        </InputSelect>
                    </div>
                <InputNumber min="0" @bind-Value="NewDishModel.Amount" class="form-control" />
                    <div class="input-group-append">
                        <button type="button" class="btn btn-outline-success" @onclick="@AddDish">
                            AddDish
                        </button>
                    </div>
                </div>
                <hr/>
                <ul class="list-group mb-4">
                    @foreach (var dishAmount in Data.DishAmounts)
                    {
                        var dish = RestaurantDishes.Where(i => i.Id == dishAmount.Id).FirstOrDefault();
                        <li class="d-flex justify-content-between align-items-center list-group-item list-group-item-secondary">
                            <img src="@dish!.ImageUrl" height="50px"/>
                            <span>
                                @dish.Name @dishAmount.Amount
                                <button class="btn btn-danger btn-sm" type="button" @onclick="() => DeleteDish(dishAmount)">DeleteDish</button>
                            </span>
                        </li>
                    }
                </ul>
            </div>
        </div>

    <button type="submit" class="btn btn-success" @onclick="@Save">
        Save
    </button>

    @if (Id != Guid.Empty)
    {
        <button @onclick="@Delete" class="btn btn-danger ml-1">
            Delete
        </button>
    }
</EditForm>